var datalabel=[
      {name:'人民网',level:2,src:"img/3.png",category:0,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      {name:'新华网',level:2,src:"img/8.png",category:1,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      {name:'新浪',level:2,src:"img/sina.png",category:2,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      // {name:'腾讯',level:2,src:"img/ten.png",category:3},
      {name:'财新',level:2,src:"img/77.png",category:3,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      {name:'新华云智',level:1.5,src:"img/4.png",category:1,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      {name:'财新数据+',level:1.5,src:"img/ss.png",category:3,intro:"“财新数据+”目前包含数据、资讯、服务三部分内容，每部分含有多个内容模块，是财新全平台精华内容的汇聚"},
      {name:'新华炫知',level:1.5,src:"img/6.png",category:1,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      {name:'舆情通',level:1.5,src:"img/55.png",category:2,intro:"舆情监测、舆情预警、全网事件分析、微博事件分析、微博传播分析、舆情报告制作、竞品分析、自动舆情日周月报 等丰富的功能"},
      {name:'新浪微舆情',level:1.5,src:"img/22.png",category:2,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      {name:'人民众云',level:1.5,src:"img/45.png",category:0,intro:"众云具备轻体量，高智慧、云计算，免安装，全自助等五个特点，除了囊括舆情管理、精准传播、新媒体运营、大数据应用等功能外，“众云”涵盖千余个舆情回应案例库，两万多家微信数据，自主完成微博、微信榜单订阅和分析的“微透视”系统"},
      {name:'人民舆情工作室',level:1.5,src:"img/yuq.png",category:0,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      // {name:'企鹅风讯',level:1.5,src:"img/88.png",category:3},
      // {name:'企鹅风讯2',level:1.5,src:"img/88.png",category:3},
      {name:'财新事件库',level:1,src:"img/dd.png",category:3,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      {name:'财新企业库',level:1,src:"img/qiy.png",category:3,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"},
      {name:'财新人物库',level:1,src:"img/renw.png",category:3,intro:"  新华“云智”定位为基于移动互联网技术的产品和服务供给平台、社群平台、商务平台，旨在将新华网网络舆情监测分析中心信息资讯、舆情研报、舆情培训、监测系统、活动传播等融为一体，在统一平台上面向用户提供服务。"}
  ];
  var links2=[
      {source:'人民网',target:'人民众云'},
      {source:'人民网',target:'人民舆情工作室'},
      {source:'新华网',target:'新华云智'},
      {source:'新华网',target:'新华炫知'},
      {source:'新浪',target:'新浪微舆情'},
      {source:'新浪',target:'舆情通'},
      {source:'财新',target:'财新数据+'},
      {source:'财新数据+',target:'财新事件库'},
      {source:'财新',target:'财新事件库'},
      {source:'财新',target:'财新企业库'},
      {source:'财新',target:'财新人物库'},
      {source:'财新数据+',target:'财新企业库'},
      {source:'财新数据+',target:'财新人物库'},
      // {source:'腾讯',target:'企鹅风讯'},
      // {source:'腾讯',target:'企鹅风讯2'},


  ];
// 2.定义关系

function forcesi(data,links,ci) {
    var xCenter = [100,430,1100,780]
    var yCenter = [90,90,90,90]
    var forcegen=d3.forceSimulation()
                   .force("x",d3.forceX().x(function (d) {
                  return xCenter[d.category];
              }))
                   .force("y", d3.forceY().y(function(d) {
         return yCenter[d.category];}
))
                   .force("charge",d3.forceManyBody().strength(-5))
                   .force("link",d3.forceLink().id(function (d) {
                       return d.name;
                   }))
                   .force('collision', d3.forceCollide().radius(function (d) {
                              var val=0;
                     if (d.level==1) {
                       return 34;
                     }else {
                       return d.level*25
                     }
                   }))
    forcegen.nodes(data).on("tick",function (d,i) {
        lines.attr("x1",function (d,i) {
                    return d.source.x
                })
                .attr("y1",function (d,i) {
                     return d.source.y
                })
                .attr("x2",function (d,i) {
                    return d.target.x
                })
                .attr("y2",function (d,i) {
                     return d.target.y
                })
                .attr("stroke","#c1e32b")
                .attr("stroke-width",0)
        circles.attr("x",function (d,i) {
                       return d.x
                   })
                .attr("y",function (d,i) {
                       return d.y})
                .on("click",function (d) {
                    console.log(d);
                    $("#box6").text("")
                    var dintro=d.intro
                    d3.select('#box6').selectAll("text").remove()
                    d3.select('#box6').append("text")
                                      .classed("tx",true)
                                      .text(dintro)
                                      .attr("fill","#747702")
                })
    })
    var dragging=d3.drag()
                  .on("start",function () {
                      d3.event.subject.ox = d3.event.subject.x;
                      d3.event.subject.oy = d3.event.subject.y;
                      if (!d3.event.active) forcegen.alphaTarget(0.3).restart();
                  })
                  .on('drag', function(event) {
                    console.log(d3.event.y);
                    if (d3.event.y<0) {
                      d3.event.y=0;
                    }else if (d3.event.y>100) {
                       d3.event.y=100
                    }
                      d3.event.subject.x = d3.event.x;
                      d3.event.subject.y = d3.event.y;
                  })
                  .on('end',function (event) {
                      // if (!d3.event.active) forcegen.alphaTarget(0);
                      d3.event.subject.x = d3.event.subject.ox;
                      d3.event.subject.y = d3.event.subject.oy;
                  })
    forcegen.force("link").links(links)
    var holder=svf.append("g")
                    .classed("gimg"+ci,true)

    var circles=holder.selectAll("image")
                    .data(data)
                    .enter()
                    .append("image")
                    .attr("href",function (d,i) {
                        console.log(d);
                        return d.src;
                         // return "img/index001_person0"+(i+1)+".png"
                     })
                     .attr("width",function (d) {
                         d.level*30
                     })
                     .attr("height",function (d) {
                         d.level*30
                     })

            circles.call(dragging)

     var lines=svf.append("g")
                  .classed("gl",true)
                  .classed("gl"+ci,true)
                  .selectAll("line")
                  .data(links)
                  .enter()
                  .append("line")
}

var svf=d3.select("#ooo")
          .append("svg")
          .attr("width",1300)
          .attr("height",250)
          .attr("transform","translate(0,0)")
